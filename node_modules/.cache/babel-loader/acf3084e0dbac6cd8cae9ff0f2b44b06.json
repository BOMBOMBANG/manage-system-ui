{"remainingRequest":"D:\\working\\manage-system-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\working\\manage-system-ui\\src\\utils\\axios.js","dependencies":[{"path":"D:\\working\\manage-system-ui\\src\\utils\\axios.js","mtime":1560737036552},{"path":"D:\\working\\manage-system-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\manage-system-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import axios from \"axios\";\nimport router from \"../router\";\nimport CookieUtils from \"./cookies\";\nimport { token } from \"./cookies\";\nimport { Message } from \"element-ui\";\nimport NProgress from \"nprogress\";\nimport \"nprogress/nprogress.css\";\nimport { validateNull } from \"./validate-utils\";\nimport home from \"../store/modules/home\";\naxios.defaults.timeout = 30000; //跨域允许保存Cookie\n\naxios.defaults.withCredentials = false; // console.log(home.state.hostname);\n\naxios.defaults.baseURL = home.state.hostname;\nNProgress.configure({\n  showSpinner: false\n}); // NProgress Configuration\n// console.log(CookieUtils.get(token));\n\nif (home.state.access_token) {\n  //console.log(home.state.access_token, \"RJCtoken\");\n  axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + home.state.access_token; //config.headers[\"Authorization\"] = \"Bearer \" + home.state.access_token; // 让每个请求携带token--['X-Token']为自定义key 请根据实际情况自行修改\n} else if (CookieUtils.get(token)) {\n  axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + CookieUtils.get(token);\n}\n/**\r\n * request拦截\r\n */\n\n\naxios.interceptors.request.use(function (config) {\n  NProgress.start(); // console.log(home.state.access_token);\n\n  if (home.state.access_token) {\n    //console.log(home.state.access_token, \"RJCtoken\");\n    axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + home.state.access_token; //config.headers[\"Authorization\"] = \"Bearer \" + home.state.access_token; // 让每个请求携带token--['X-Token']为自定义key 请根据实际情况自行修改\n  }\n\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n});\n/**\r\n * response 拦截\r\n */\n\naxios.interceptors.response.use(function (response) {\n  NProgress.done(); // console.log(response);\n\n  if (!validateNull(response.data.success)) {\n    if (response.data.success === false) {\n      Message.error(response.data.msg);\n      return Promise.reject(response.data.msg);\n    }\n  }\n\n  return response.data;\n}, function (error) {\n  // console.log(error.response);\n  NProgress.done();\n  var code = error.response.status;\n\n  switch (code) {\n    case 400:\n      error.message = error.response.data.msg || error.response.data.message || \"错误请求\";\n      break;\n\n    case 401:\n      error.message = error.response.data.msg || error.response.data.message || \"未授权,请重新登录\";\n      break;\n\n    case 403:\n      error.message = error.response.data.msg || error.response.data.message || \"禁止访问\";\n      break;\n\n    case 404:\n      error.message = error.response.data.msg || error.response.data.message || \"请求错误,未找到该资源\";\n      break;\n\n    case 405:\n      error.message = error.response.data.msg || error.response.data.message || \"请求方法未允许\";\n      break;\n\n    case 408:\n      error.message = error.response.data.msg || error.response.data.message || \"请求超时\";\n      break;\n\n    case 500:\n      error.message = error.response.data.msg || error.response.data.message || \"服务器错误\";\n      break;\n\n    case 501:\n      error.message = error.response.data.msg || error.response.data.message || \"网络未实现\";\n      break;\n\n    case 502:\n      error.message = error.response.data.msg || error.response.data.message || \"网络错误\";\n      break;\n\n    case 503:\n      error.message = \"服务不可用\";\n      break;\n\n    case 504:\n      error.message = \"网络超时\";\n      break;\n\n    case 505:\n      error.message = \"http版本不支持该请求\";\n      break;\n\n    default:\n      error.message = error.response.data.msg;\n  }\n\n  Message.error(error.message);\n\n  if (parseInt(code) === 401 && router.app._route.fullPath !== '/') {\n    // console.log(router.app._route.fullPath);\n    router.push({\n      name: 'Login',\n      params: {\n        path: router.app._route.fullPath\n      }\n    });\n    CookieUtils.remove(token);\n  }\n\n  return Promise.reject(error.message);\n});\nexport default axios;",{"version":3,"sources":["D:\\working\\manage-system-ui\\src\\utils\\axios.js"],"names":["axios","router","CookieUtils","token","Message","NProgress","validateNull","home","defaults","timeout","withCredentials","baseURL","state","hostname","configure","showSpinner","access_token","headers","common","get","interceptors","request","use","config","start","error","Promise","reject","response","done","data","success","msg","code","status","message","parseInt","app","_route","fullPath","push","name","params","path","remove"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport router from \"../router\";\r\nimport CookieUtils from \"./cookies\";\r\nimport { token } from \"./cookies\"\r\nimport { Message } from \"element-ui\";\r\nimport NProgress from \"nprogress\";\r\nimport \"nprogress/nprogress.css\";\r\nimport { validateNull } from \"./validate-utils\";\r\nimport home from \"../store/modules/home\"\r\n\r\naxios.defaults.timeout = 30000;\r\n//跨域允许保存Cookie\r\naxios.defaults.withCredentials = false;\r\n// console.log(home.state.hostname);\r\n\r\naxios.defaults.baseURL = home.state.hostname;\r\nNProgress.configure({ showSpinner: false }); // NProgress Configuration\r\n\r\n// console.log(CookieUtils.get(token));\r\nif (home.state.access_token) {\r\n  //console.log(home.state.access_token, \"RJCtoken\");\r\n  axios.defaults.headers.common[\"Authorization\"] =\r\n    \"Bearer \" + home.state.access_token;\r\n  //config.headers[\"Authorization\"] = \"Bearer \" + home.state.access_token; // 让每个请求携带token--['X-Token']为自定义key 请根据实际情况自行修改\r\n}\r\nelse if(CookieUtils.get(token)) {\r\n  axios.defaults.headers.common[\"Authorization\"] =\r\n    \"Bearer \" + CookieUtils.get(token);\r\n}\r\n/**\r\n * request拦截\r\n */\r\naxios.interceptors.request.use(\r\n  function(config) {\r\n    NProgress.start();\r\n    // console.log(home.state.access_token);\r\n\r\n    if (home.state.access_token) {\r\n      //console.log(home.state.access_token, \"RJCtoken\");\r\n      axios.defaults.headers.common[\"Authorization\"] =\r\n        \"Bearer \" + home.state.access_token;\r\n      //config.headers[\"Authorization\"] = \"Bearer \" + home.state.access_token; // 让每个请求携带token--['X-Token']为自定义key 请根据实际情况自行修改\r\n    }\r\n    return config;\r\n  },\r\n  error => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n/**\r\n * response 拦截\r\n */\r\naxios.interceptors.response.use(\r\n  response => {\r\n    NProgress.done();\r\n    // console.log(response);\r\n    if (!validateNull(response.data.success)) {\r\n      if (response.data.success === false) {\r\n        Message.error(response.data.msg);\r\n        return Promise.reject(response.data.msg);\r\n      }\r\n    }\r\n    return response.data;\r\n  },\r\n  error => {\r\n    // console.log(error.response);\r\n    NProgress.done();\r\n    let code = error.response.status;\r\n    switch (code) {\r\n      case 400:\r\n        error.message = error.response.data.msg || error.response.data.message || \"错误请求\";\r\n        break;\r\n      case 401:\r\n        error.message = error.response.data.msg || error.response.data.message || \"未授权,请重新登录\";\r\n        break;\r\n      case 403:\r\n        error.message = error.response.data.msg || error.response.data.message || \"禁止访问\";\r\n        break;\r\n      case 404:\r\n        error.message = error.response.data.msg || error.response.data.message || \"请求错误,未找到该资源\";\r\n        break;\r\n      case 405:\r\n        error.message = error.response.data.msg || error.response.data.message || \"请求方法未允许\";\r\n        break;\r\n      case 408:\r\n        error.message = error.response.data.msg || error.response.data.message || \"请求超时\";\r\n        break;\r\n      case 500:\r\n        error.message = error.response.data.msg || error.response.data.message || \"服务器错误\";\r\n        break;\r\n      case 501:\r\n        error.message = error.response.data.msg || error.response.data.message || \"网络未实现\";\r\n        break;\r\n      case 502:\r\n        error.message = error.response.data.msg || error.response.data.message || \"网络错误\";\r\n        break;\r\n      case 503:\r\n        error.message = \"服务不可用\";\r\n        break;\r\n      case 504:\r\n        error.message = \"网络超时\";\r\n        break;\r\n      case 505:\r\n        error.message = \"http版本不支持该请求\";\r\n        break;\r\n      default:\r\n        error.message = error.response.data.msg;\r\n    }\r\n    Message.error(error.message);\r\n    \r\n    if (parseInt(code) === 401 && router.app._route.fullPath !== '/') {\r\n      // console.log(router.app._route.fullPath);\r\n      router.push({\r\n        name: 'Login',\r\n        params: {\r\n          path: router.app._route.fullPath\r\n        }\r\n      })\r\n      CookieUtils.remove(token)\r\n    }\r\n    return Promise.reject(error.message);\r\n  }\r\n);\r\nexport default axios;\r\n"]}]}