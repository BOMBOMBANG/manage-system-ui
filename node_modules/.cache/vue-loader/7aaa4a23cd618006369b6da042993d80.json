{"remainingRequest":"D:\\working\\manage-system-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\manage-system-ui\\src\\components\\header\\systemHeader.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\working\\manage-system-ui\\src\\components\\header\\systemHeader.vue","mtime":1560740419869},{"path":"D:\\working\\manage-system-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\manage-system-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\working\\manage-system-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\manage-system-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n// import { mapGetters } from 'vuex';\r\nimport {storageFetch, sessionFetch, userInfoKey } from \"^/storage\"\r\nimport CookieUtils from \"^/cookies\";\r\nimport { token } from \"^/cookies\"\r\nimport { createDriver, openDriver } from '@/mixins'\r\nexport default {\r\n  mixins: [createDriver, openDriver],\r\n  data() {\r\n    const validatePassword = (rules, value, callback) => {\r\n    if (value == '') {\r\n      callback(new Error(\"请再次输入密码\"));\r\n      } else if (value !== this.form.newPassword) {\r\n        callback(new Error(\"两次输入的密码不一致\"))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      form: {\r\n        oldPassword: '',\r\n        newPassword: '',\r\n        checkPassword: ''\r\n      },\r\n      rules: {\r\n        oldPassword: [\r\n        {require: true, message: '旧密码不能为空', trigger: 'blur'},\r\n        ],\r\n        newPassword: [\r\n        {required: true, message: '新密码不能为空', trigger: 'blur'}\r\n        ],\r\n        checkPassword: [\r\n        {validator: validatePassword, trigger: 'blur'}\r\n        ]\r\n      },\r\n      changePSW: false,\r\n      personalInfo: false,\r\n      personalInfoObj: {},\r\n      userInfoForm: {\r\n        age: '年龄',\r\n        email: \"电子邮箱\",\r\n        nickname: \"姓名\",\r\n        searchTeamName: '科研团队名称',\r\n        teacherType: '老师类型',\r\n        userDepName: \"系别\",\r\n        userLevel: '职位级别',\r\n        userPhone: '手机号',\r\n        username: \"账号\"\r\n      },\r\n      // isCollapse: false,\r\n      navgation: [],\r\n      logo: require(\"@/assets/logo.png\"),\r\n      defaultActive: 'route1'\r\n    }\r\n  },\r\n  computed: {\r\n    routePath() {\r\n      // console.log(this.$router);\r\n      var arr = this.$route.path.split(\"/\");\r\n      var _arr = []\r\n      for(let item of arr) {\r\n        if(item == 'home')\r\n          _arr.push({\r\n            to: '/home',\r\n            name: item\r\n          })\r\n        else\r\n          _arr.push({\r\n            to: '/home/'+item,\r\n            name: item\r\n          })\r\n          if(_arr.length == 3) break\r\n      }\r\n      return _arr;\r\n    },\r\n    // ...mapGetters(['userInfo', 'nowRoute','isCollapse', 'stepNum']),\r\n    userInfo() {\r\n      return this.$store.getters.userInfo\r\n    },\r\n    nowRoute() {\r\n      return this.$store.getters.nowRoute\r\n    },\r\n    isCollapse() {\r\n      return this.$store.getters.isCollapse\r\n    },\r\n    stepNum() {\r\n      return this.$store.getters.stepNum\r\n    },\r\n    isFristLogin() {\r\n      return this.$store.getters.isFristLogin\r\n    },\r\n    iconName() {\r\n      if(!this.isCollapse) {\r\n        return 'transiform_collapse'\r\n      }else return 'transiform'\r\n    }\r\n  },\r\n  methods: {\r\n    changePassword(name) {\r\n      this.$refs[name].validate((valid) => {\r\n        //修改密码\r\n      })\r\n    },\r\n    handleOpen(key, keyPath) {\r\n      // console.log(key, keyPath);\r\n    },\r\n    handleClose(key, keyPath) {\r\n      // console.log(key, keyPath);\r\n    },\r\n    handleZoom() {\r\n      this.$store.commit(\"SET_isCollapse\",!this.isCollapse)\r\n      this.$emit('zoom', this.isCollapse)\r\n    },\r\n    handleSelect(index, indexPath) {\r\n      this.$store.commit('SET_nowRoute', index)\r\n      this.$emit('routeJump', index)\r\n      if(indexPath.length>1) {\r\n        for(let i = 0; i<this.navgation[indexPath[0]-1].children.length; i++) {\r\n          if(this.navgation[indexPath[0]-1].children[i].routeName == index) {\r\n            this.$store.commit('PUSH_tabs', {\r\n              'name': index,\r\n              'title':this.navgation[indexPath[0]-1].children[i].name\r\n            })\r\n            return\r\n          }\r\n        }\r\n      }else {\r\n        for(let i = 0; i<this.navgation.length; i++) {\r\n          if(this.navgation[i].routeName == index) {\r\n            this.$store.commit('PUSH_tabs', {\r\n              'name': index,\r\n              'title':this.navgation[i].name\r\n            })\r\n            return\r\n          }\r\n        }\r\n      }\r\n    },\r\n    handelChangeDro(command) {\r\n      switch(command) {\r\n        case 'PSW':\r\n          this.changePSW = true\r\n          break\r\n        case 'Info':\r\n          this.personalInfo = true\r\n          this.handleGetPersonalInfo()\r\n          break;\r\n        case 'exit':\r\n          this.$store.commit('SET_tabs', [])\r\n          CookieUtils.remove(token)\r\n          this.$router.push('/')\r\n      }\r\n    },\r\n    handleRefresh() {\r\n      this.$emit('on-refresh')\r\n    },\r\n    handleGetPersonalInfo() {\r\n      //获取用户信息\r\n    },\r\n    handleOpenDriver() {\r\n      // console.log(this.nowRoute);\r\n      switch( this.nowRoute ) {\r\n        case 'home':\r\n          this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case undefined:\r\n          this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case '0':\r\n            this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case 'uploadAchievement':\r\n          this.handleUploadOpenDriver()\r\n          break\r\n        default: this.$Message.warning('该页面没有引导')\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    if(this.userInfo == '') {\r\n      this.$store.commit(\"SET_userInfo\",storageFetch(userInfoKey))\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["systemHeader.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"systemHeader.vue","sourceRoot":"src/components/header","sourcesContent":["<template>\r\n  <header>\r\n    <div class=\"top\">\r\n      <div @click=\"handleZoom()\" class=\"option\">\r\n        <Icon :class=\"iconName\" type=\"md-menu\"/>\r\n      </div>\r\n\r\n      <div class=\"breadcrumbItem\">\r\n        <Breadcrumb>\r\n          <BreadcrumbItem :to=\"item.to\" v-for=\"(item,index) in routePath\" :key=\"`ROUTE_PATH_${index}`\"><span style=\"color: #fff\">{{item.name}}</span></BreadcrumbItem>\r\n        </Breadcrumb>\r\n      </div>\r\n\r\n      <div class=\"refresh\">\r\n        <Button icon=\"md-refresh\" type=\"text\" @click=\"handleRefresh\">刷新</Button>\r\n      </div>\r\n      <el-dropdown @command=\"handelChangeDro\" class=\"personal\">\r\n        <div class=\"avatar\">\r\n          <Icon type=\"md-person\" /><p>{{$store.state.home.userInfo.nickname}}</p>\r\n        </div>\r\n        <el-dropdown-menu slot=\"dropdown\">\r\n          <el-dropdown-item command=\"Info\">个人信息</el-dropdown-item>\r\n          <el-dropdown-item command=\"PSW\">修改密码</el-dropdown-item>\r\n          <el-dropdown-item command=\"exit\">退出</el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </el-dropdown>\r\n      <Button id=\"modal-step-button\" @click.prevent.stop=\"handleOpenDriver()\" class=\"button\" icon=\"md-help\" shape=\"circle\" style=\"margin:0 10px\" type=\"primary\" ></Button>\r\n    </div>\r\n\r\n  <Modal v-model=\"changePSW\" width=\"450\">\r\n    <p slot=\"header\" style=\"text-align:center\">\r\n    <span style=\"text-align:20px\">修改密码</span>\r\n    </p>\r\n    <div style=\"text-align:center;\">\r\n    <Form :model=\"form\" :rules=\"rules\" ref=\"formPassword\" label-position=\"right\" :label-width=\"100\">\r\n      <FormItem prop=\"oldPassword\" label=\"原密码\">\r\n      <Input type=\"password\" v-model.trim=\"form.oldPassword\" placeholder=\"请输入旧密码\"\r\n         style=\"width: 260px\"/>\r\n      </FormItem>\r\n      <FormItem prop=\"newPassword\" label=\"新密码\">\r\n      <Input type=\"password\" v-model.trim=\"form.newPassword\" placeholder=\"请输入新密码\"\r\n         style=\"width: 260px\"/>\r\n      </FormItem>\r\n      <FormItem prop=\"checkPassword\" label=\"确认密码\">\r\n      <Input type=\"password\" v-model.trim=\"form.checkPassword\" placeholder=\"请再次输入新密码\"\r\n         style=\"width: 260px\"/>\r\n      </FormItem>\r\n    </Form>\r\n    </div>\r\n    <div slot=\"footer\" style=\"text-align:center\">\r\n      <Button type=\"primary\" @click=\"changePassword('formPassword')\" style=\"width:60px\">修改</Button>\r\n      <Button type=\"default\" @click=\"changePSW=false\" style=\"width:60px\">取消</Button>\r\n    </div>\r\n  </Modal>\r\n\r\n  <Modal\r\n    v-model=\"personalInfo\"\r\n    title=\"个人信息\"\r\n    >\r\n    <div class=\"form\">\r\n      <div class=\"form-item\" v-for=\"(item,key) of userInfoForm\" :key=\"key\">\r\n        <p class=\"title\">{{item}}：</p>\r\n        <Input class=\"input\" disabled :value=\"personalInfoObj[key]\" placeholder=\"暂无\"></Input>\r\n      </div>\r\n    </div>\r\n  </Modal>\r\n  </header>\r\n</template>\r\n\r\n<script>\r\n// import { mapGetters } from 'vuex';\r\nimport {storageFetch, sessionFetch, userInfoKey } from \"^/storage\"\r\nimport CookieUtils from \"^/cookies\";\r\nimport { token } from \"^/cookies\"\r\nimport { createDriver, openDriver } from '@/mixins'\r\nexport default {\r\n  mixins: [createDriver, openDriver],\r\n  data() {\r\n    const validatePassword = (rules, value, callback) => {\r\n    if (value == '') {\r\n      callback(new Error(\"请再次输入密码\"));\r\n      } else if (value !== this.form.newPassword) {\r\n        callback(new Error(\"两次输入的密码不一致\"))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      form: {\r\n        oldPassword: '',\r\n        newPassword: '',\r\n        checkPassword: ''\r\n      },\r\n      rules: {\r\n        oldPassword: [\r\n        {require: true, message: '旧密码不能为空', trigger: 'blur'},\r\n        ],\r\n        newPassword: [\r\n        {required: true, message: '新密码不能为空', trigger: 'blur'}\r\n        ],\r\n        checkPassword: [\r\n        {validator: validatePassword, trigger: 'blur'}\r\n        ]\r\n      },\r\n      changePSW: false,\r\n      personalInfo: false,\r\n      personalInfoObj: {},\r\n      userInfoForm: {\r\n        age: '年龄',\r\n        email: \"电子邮箱\",\r\n        nickname: \"姓名\",\r\n        searchTeamName: '科研团队名称',\r\n        teacherType: '老师类型',\r\n        userDepName: \"系别\",\r\n        userLevel: '职位级别',\r\n        userPhone: '手机号',\r\n        username: \"账号\"\r\n      },\r\n      // isCollapse: false,\r\n      navgation: [],\r\n      logo: require(\"@/assets/logo.png\"),\r\n      defaultActive: 'route1'\r\n    }\r\n  },\r\n  computed: {\r\n    routePath() {\r\n      // console.log(this.$router);\r\n      var arr = this.$route.path.split(\"/\");\r\n      var _arr = []\r\n      for(let item of arr) {\r\n        if(item == 'home')\r\n          _arr.push({\r\n            to: '/home',\r\n            name: item\r\n          })\r\n        else\r\n          _arr.push({\r\n            to: '/home/'+item,\r\n            name: item\r\n          })\r\n          if(_arr.length == 3) break\r\n      }\r\n      return _arr;\r\n    },\r\n    // ...mapGetters(['userInfo', 'nowRoute','isCollapse', 'stepNum']),\r\n    userInfo() {\r\n      return this.$store.getters.userInfo\r\n    },\r\n    nowRoute() {\r\n      return this.$store.getters.nowRoute\r\n    },\r\n    isCollapse() {\r\n      return this.$store.getters.isCollapse\r\n    },\r\n    stepNum() {\r\n      return this.$store.getters.stepNum\r\n    },\r\n    isFristLogin() {\r\n      return this.$store.getters.isFristLogin\r\n    },\r\n    iconName() {\r\n      if(!this.isCollapse) {\r\n        return 'transiform_collapse'\r\n      }else return 'transiform'\r\n    }\r\n  },\r\n  methods: {\r\n    changePassword(name) {\r\n      this.$refs[name].validate((valid) => {\r\n        //修改密码\r\n      })\r\n    },\r\n    handleOpen(key, keyPath) {\r\n      // console.log(key, keyPath);\r\n    },\r\n    handleClose(key, keyPath) {\r\n      // console.log(key, keyPath);\r\n    },\r\n    handleZoom() {\r\n      this.$store.commit(\"SET_isCollapse\",!this.isCollapse)\r\n      this.$emit('zoom', this.isCollapse)\r\n    },\r\n    handleSelect(index, indexPath) {\r\n      this.$store.commit('SET_nowRoute', index)\r\n      this.$emit('routeJump', index)\r\n      if(indexPath.length>1) {\r\n        for(let i = 0; i<this.navgation[indexPath[0]-1].children.length; i++) {\r\n          if(this.navgation[indexPath[0]-1].children[i].routeName == index) {\r\n            this.$store.commit('PUSH_tabs', {\r\n              'name': index,\r\n              'title':this.navgation[indexPath[0]-1].children[i].name\r\n            })\r\n            return\r\n          }\r\n        }\r\n      }else {\r\n        for(let i = 0; i<this.navgation.length; i++) {\r\n          if(this.navgation[i].routeName == index) {\r\n            this.$store.commit('PUSH_tabs', {\r\n              'name': index,\r\n              'title':this.navgation[i].name\r\n            })\r\n            return\r\n          }\r\n        }\r\n      }\r\n    },\r\n    handelChangeDro(command) {\r\n      switch(command) {\r\n        case 'PSW':\r\n          this.changePSW = true\r\n          break\r\n        case 'Info':\r\n          this.personalInfo = true\r\n          this.handleGetPersonalInfo()\r\n          break;\r\n        case 'exit':\r\n          this.$store.commit('SET_tabs', [])\r\n          CookieUtils.remove(token)\r\n          this.$router.push('/')\r\n      }\r\n    },\r\n    handleRefresh() {\r\n      this.$emit('on-refresh')\r\n    },\r\n    handleGetPersonalInfo() {\r\n      //获取用户信息\r\n    },\r\n    handleOpenDriver() {\r\n      // console.log(this.nowRoute);\r\n      switch( this.nowRoute ) {\r\n        case 'home':\r\n          this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case undefined:\r\n          this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case '0':\r\n            this.driverHome()\r\n          // console.log('home');\r\n          break\r\n        case 'uploadAchievement':\r\n          this.handleUploadOpenDriver()\r\n          break\r\n        default: this.$Message.warning('该页面没有引导')\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    if(this.userInfo == '') {\r\n      this.$store.commit(\"SET_userInfo\",storageFetch(userInfoKey))\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../styles/index\";\r\n$header-height: 50px;\r\n\r\nheader{\r\n  .button{\r\n    &:hover{\r\n      position: relative;\r\n      &::after{\r\n        background: #fff;\r\n        @include flex;\r\n        width: 60px;\r\n        height: 30px;\r\n        border-radius: 5px;\r\n        box-shadow: 0 0 5px #666;\r\n        position: absolute;\r\n        color: #000;\r\n        content: \"打开引导\";\r\n        font-size: 12px;\r\n        top: 25px;\r\n        left: -55px;\r\n      }\r\n    }\r\n  }\r\n  position: relative;\r\n  width: 100%;\r\n  height: 50px;\r\n  background: $primary-color;\r\n  // @include flex;\r\n  font-size: $font-size-base;\r\n  color: $title-color\r\n}\r\n.top{\r\n  width: 100%;\r\n  position: absolute;\r\n  height: 50px;\r\n  background: $primary-color;\r\n  color: #ffffff;\r\n  @include flex;\r\n  justify-content: flex-start;\r\n  .option{\r\n    cursor: pointer;\r\n    @include flex;\r\n    width: 80px;\r\n    font-size: 25px;\r\n    .transiform_collapse,\r\n    .transiform{\r\n      transition: 0.2s\r\n    }\r\n    .transiform{\r\n      transform: rotateZ(90deg);\r\n    }\r\n  }\r\n  .refresh{\r\n    button{\r\n      color: #fff;\r\n      &:hover{\r\n        background: $primary-color;\r\n        color: #dddddd;\r\n      }\r\n    }\r\n    margin-left: $base-margin;\r\n    font-size: 15px\r\n  }\r\n  .personal{\r\n    margin-left: auto;\r\n    margin-right: $base-margin*1.5;\r\n    .avatar{\r\n      font-size: 20px;\r\n      cursor: pointer;\r\n      @include flex;\r\n      color: #fff\r\n      // p{\r\n      //   font-size: 25px\r\n      // }\r\n    }\r\n  }\r\n}\r\n.form{\r\n  @include flex;\r\n  flex-direction: column;\r\n  &-item{\r\n    margin: $base-margin*0.5 auto;\r\n    @include flex;\r\n    width: 100%;\r\n    p{\r\n      width: 120px\r\n    }\r\n    .input{\r\n      flex: 1\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}